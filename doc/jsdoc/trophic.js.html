<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>trophic.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css" />
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css" />
    <script src="scripts/nav.js" defer></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <input type="checkbox" id="nav-trigger" class="nav-trigger" />
    <label for="nav-trigger" class="navicon-button x">
      <div class="navicon"></div>
    </label>

    <label for="nav-trigger" class="overlay"></label>

    <nav>
      <h2><a href="index.html">Home</a></h2>
      <h3>Classes</h3>
      <ul>
        <li><a href="module.exports.html">exports</a></li>
      </ul>
      <h3>Global</h3>
      <ul>
        <li><a href="global.html#LEGENDHEIGHT">LEGENDHEIGHT</a></li>
        <li><a href="global.html#MIN_WIDTH">MIN_WIDTH</a></li>
        <li><a href="global.html#SHORTLABELLEN">SHORTLABELLEN</a></li>
        <li><a href="global.html#TITLELISTLEN">TITLELISTLEN</a></li>
        <li><a href="global.html#addColumn">addColumn</a></li>
        <li><a href="global.html#addContextMenu">addContextMenu</a></li>
        <li><a href="global.html#addEventListeners">addEventListeners</a></li>
        <li><a href="global.html#addLabel">addLabel</a></li>
        <li><a href="global.html#addRollbackIcon">addRollbackIcon</a></li>
        <li><a href="global.html#addVec">addVec</a></li>
        <li><a href="global.html#alertMsg">alertMsg</a></li>
        <li><a href="global.html#analyse">analyse</a></li>
        <li><a href="global.html#anon">anon</a></li>
        <li><a href="global.html#applySampleToLink">applySampleToLink</a></li>
        <li><a href="global.html#arrayBufferToString">arrayBufferToString</a></li>
        <li><a href="global.html#arrowMove">arrowMove</a></li>
        <li><a href="global.html#asleep">asleep</a></li>
        <li><a href="global.html#autoLayout">autoLayout</a></li>
        <li><a href="global.html#betweenness">betweenness</a></li>
        <li><a href="global.html#betweenness1">betweenness1</a></li>
        <li><a href="global.html#bringToFront">bringToFront</a></li>
        <li><a href="global.html#buttonIsDisabled">buttonIsDisabled</a></li>
        <li><a href="global.html#cancelAdd">cancelAdd</a></li>
        <li><a href="global.html#cancelAlertMsg">cancelAlertMsg</a></li>
        <li><a href="global.html#cancelEdit">cancelEdit</a></li>
        <li><a href="global.html#cancelHiddenStyles">cancelHiddenStyles</a></li>
        <li><a href="global.html#cancelLoading">cancelLoading</a></li>
        <li><a href="global.html#cancelViewOnly">cancelViewOnly</a></li>
        <li><a href="global.html#changeCursor">changeCursor</a></li>
        <li><a href="global.html#changeRoom">changeRoom</a></li>
        <li><a href="global.html#checkComplete">checkComplete</a></li>
        <li><a href="global.html#circleIntersectsRect">circleIntersectsRect</a></li>
        <li><a href="global.html#clean">clean</a></li>
        <li><a href="global.html#cleanArray">cleanArray</a></li>
        <li><a href="global.html#cleanLocalStorage">cleanLocalStorage</a></li>
        <li><a href="global.html#clearLegend">clearLegend</a></li>
        <li><a href="global.html#clearMap">clearMap</a></li>
        <li><a href="global.html#clearPopUp">clearPopUp</a></li>
        <li><a href="global.html#clearStatusBar">clearStatusBar</a></li>
        <li><a href="global.html#closeFilter">closeFilter</a></li>
        <li><a href="global.html#closeOptionsDialogs">closeOptionsDialogs</a></li>
        <li><a href="global.html#cluster">cluster</a></li>
        <li><a href="global.html#clusterByAttribute">clusterByAttribute</a></li>
        <li><a href="global.html#clusterByColor">clusterByColor</a></li>
        <li><a href="global.html#clusterByLouvain">clusterByLouvain</a></li>
        <li><a href="global.html#clusterByStyle">clusterByStyle</a></li>
        <li><a href="global.html#clusterGroups">clusterGroups</a></li>
        <li><a href="global.html#clusterImage">clusterImage</a></li>
        <li><a href="global.html#collapseColGroup">collapseColGroup</a></li>
        <li><a href="global.html#collapseNotes">collapseNotes</a></li>
        <li><a href="global.html#colorEditor">colorEditor</a></li>
        <li><a href="global.html#connected">connected</a></li>
        <li><a href="global.html#connectedComponents">connectedComponents</a></li>
        <li><a href="global.html#convertDashes">convertDashes</a></li>
        <li><a href="global.html#convertData">convertData</a></li>
        <li><a href="global.html#convertEdge">convertEdge</a></li>
        <li><a href="global.html#convertEdgeBack">convertEdgeBack</a></li>
        <li><a href="global.html#convertNode">convertNode</a></li>
        <li><a href="global.html#convertNodeBack">convertNodeBack</a></li>
        <li><a href="global.html#copyAsText">copyAsText</a></li>
        <li><a href="global.html#copyBackgroundToClipboard">copyBackgroundToClipboard</a></li>
        <li><a href="global.html#copyHistoryToClipboard">copyHistoryToClipboard</a></li>
        <li><a href="global.html#copyTable">copyTable</a></li>
        <li><a href="global.html#copyToClipboard">copyToClipboard</a></li>
        <li><a href="global.html#createTitleDropDown">createTitleDropDown</a></li>
        <li><a href="global.html#deepCopy">deepCopy</a></li>
        <li><a href="global.html#deleteActiveObjects">deleteActiveObjects</a></li>
        <li><a href="global.html#deleteColumn">deleteColumn</a></li>
        <li><a href="global.html#deleteNode">deleteNode</a></li>
        <li><a href="global.html#deselectTool">deselectTool</a></li>
        <li><a href="global.html#diag">diag</a></li>
        <li><a href="global.html#diffMaps">diffMaps</a></li>
        <li><a href="global.html#display">display</a></li>
        <li><a href="global.html#displayHelp">displayHelp</a></li>
        <li><a href="global.html#displayNetPane">displayNetPane</a></li>
        <li><a href="global.html#displayNoServerWarning">displayNoServerWarning</a></li>
        <li><a href="global.html#displayWhatsNew">displayWhatsNew</a></li>
        <li><a href="global.html#doSearch">doSearch</a></li>
        <li><a href="global.html#dragElement">dragElement</a></li>
        <li><a href="global.html#draw">draw</a></li>
        <li><a href="global.html#drawBadges">drawBadges</a></li>
        <li><a href="global.html#drawMinimap">drawMinimap</a></li>
        <li><a href="global.html#duplEdge">duplEdge</a></li>
        <li><a href="global.html#edgeListToAdjMatrix">edgeListToAdjMatrix</a></li>
        <li><a href="global.html#editEdge">editEdge</a></li>
        <li><a href="global.html#editLinkStyle">editLinkStyle</a></li>
        <li><a href="global.html#editNode">editNode</a></li>
        <li><a href="global.html#editNodeStyle">editNodeStyle</a></li>
        <li><a href="global.html#elem">elem</a></li>
        <li><a href="global.html#encodeHTMLEntities">encodeHTMLEntities</a></li>
        <li><a href="global.html#eqArray">eqArray</a></li>
        <li><a href="global.html#eraser">eraser</a></li>
        <li><a href="global.html#exactTime">exactTime</a></li>
        <li><a href="global.html#expandStylesObject">expandStylesObject</a></li>
        <li><a href="global.html#exportDOT">exportDOT</a></li>
        <li><a href="global.html#exportExcel">exportExcel</a></li>
        <li><a href="global.html#exportGEXF">exportGEXF</a></li>
        <li><a href="global.html#exportGML">exportGML</a></li>
        <li><a href="global.html#exportNotes">exportNotes</a></li>
        <li><a href="global.html#factorSizeToPercent">factorSizeToPercent</a></li>
        <li><a href="global.html#fit">fit</a></li>
        <li><a href="global.html#follow">follow</a></li>
        <li><a href="global.html#followUser">followUser</a></li>
        <li><a href="global.html#genAIEdge">genAIEdge</a></li>
        <li><a href="global.html#genAINode">genAINode</a></li>
        <li><a href="global.html#generateName">generateName</a></li>
        <li><a href="global.html#generateRoom">generateRoom</a></li>
        <li><a href="global.html#getArrows">getArrows</a></li>
        <li><a href="global.html#getButtonStatus">getButtonStatus</a></li>
        <li><a href="global.html#getClipboardContents">getClipboardContents</a></li>
        <li><a href="global.html#getDashes">getDashes</a></li>
        <li><a href="global.html#getIds">getIds</a></li>
        <li><a href="global.html#getLastPath">getLastPath</a></li>
        <li><a href="global.html#getNodeGroupFromGroupLabel">getNodeGroupFromGroupLabel</a></li>
        <li><a href="global.html#getObjectData">getObjectData</a></li>
        <li><a href="global.html#getRadioVal">getRadioVal</a></li>
        <li><a href="global.html#getRandomData">getRandomData</a></li>
        <li><a href="global.html#getScaleFreeNetwork">getScaleFreeNetwork</a></li>
        <li><a href="global.html#getSelectedAndFixedNodes">getSelectedAndFixedNodes</a></li>
        <li><a href="global.html#getWidthOfTitle">getWidthOfTitle</a></li>
        <li><a href="global.html#ghostCursor">ghostCursor</a></li>
        <li><a href="global.html#ghostFactor">ghostFactor</a></li>
        <li><a href="global.html#groupTitle">groupTitle</a></li>
        <li><a href="global.html#headerTickToggle">headerTickToggle</a></li>
        <li><a href="global.html#hexToRgba">hexToRgba</a></li>
        <li><a href="global.html#hideFactorsWithStyle">hideFactorsWithStyle</a></li>
        <li><a href="global.html#hideLinksWithStyle">hideLinksWithStyle</a></li>
        <li><a href="global.html#hideNavButtons">hideNavButtons</a></li>
        <li><a href="global.html#hideNodeAndEdges">hideNodeAndEdges</a></li>
        <li><a href="global.html#hideNotes">hideNotes</a></li>
        <li><a href="global.html#hideWhatsNew">hideWhatsNew</a></li>
        <li><a href="global.html#htmlEntities">htmlEntities</a></li>
        <li><a href="global.html#humanSize">humanSize</a></li>
        <li><a href="global.html#in_degree">in_degree</a></li>
        <li><a href="global.html#initAligningGuidelines">initAligningGuidelines</a></li>
        <li><a href="global.html#initDraw">initDraw</a></li>
        <li><a href="global.html#initPopUp">initPopUp</a></li>
        <li><a href="global.html#initSample">initSample</a></li>
        <li><a href="global.html#initialiseFactorTable">initialiseFactorTable</a></li>
        <li><a href="global.html#initialiseLinkTable">initialiseLinkTable</a></li>
        <li><a href="global.html#initials">initials</a></li>
        <li><a href="global.html#initiateClone">initiateClone</a></li>
        <li><a href="global.html#inline">inline</a></li>
        <li><a href="global.html#intersect">intersect</a></li>
        <li><a href="global.html#invertColor">invertColor</a></li>
        <li><a href="global.html#isEmpty">isEmpty</a></li>
        <li><a href="global.html#isNotCluster">isNotCluster</a></li>
        <li><a href="global.html#isQuillEmpty">isQuillEmpty</a></li>
        <li><a href="global.html#jLouvain">jLouvain</a></li>
        <li><a href="global.html#keepPaneInWindow">keepPaneInWindow</a></li>
        <li><a href="global.html#legend">legend</a></li>
        <li><a href="global.html#legendSwitch">legendSwitch</a></li>
        <li><a href="global.html#lightOrDark">lightOrDark</a></li>
        <li><a href="global.html#linkEditCancel">linkEditCancel</a></li>
        <li><a href="global.html#linkEditSave">linkEditSave</a></li>
        <li><a href="global.html#linkEditSubmit">linkEditSubmit</a></li>
        <li><a href="global.html#linkEditUpdateStyleSample">linkEditUpdateStyleSample</a></li>
        <li><a href="global.html#linkEditorHide">linkEditorHide</a></li>
        <li><a href="global.html#linkEditorShow">linkEditorShow</a></li>
        <li><a href="global.html#listFactors">listFactors</a></li>
        <li><a href="global.html#listLinks">listLinks</a></li>
        <li><a href="global.html#listen">listen</a></li>
        <li><a href="global.html#loadCSV">loadCSV</a></li>
        <li><a href="global.html#loadDOTfile">loadDOTfile</a></li>
        <li><a href="global.html#loadDrawIOfile">loadDrawIOfile</a></li>
        <li><a href="global.html#loadExcelfile">loadExcelfile</a></li>
        <li><a href="global.html#loadFile">loadFile</a></li>
        <li><a href="global.html#loadGEXFfile">loadGEXFfile</a></li>
        <li><a href="global.html#loadGML">loadGML</a></li>
        <li><a href="global.html#loadGraphML">loadGraphML</a></li>
        <li><a href="global.html#loadKumufile">loadKumufile</a></li>
        <li><a href="global.html#loadPRSMfile">loadPRSMfile</a></li>
        <li><a href="global.html#lockNode">lockNode</a></li>
        <li><a href="global.html#logHistory">logHistory</a></li>
        <li><a href="global.html#makeClusterNode">makeClusterNode</a></li>
        <li><a href="global.html#makeColor">makeColor</a></li>
        <li><a href="global.html#makeGroup">makeGroup</a></li>
        <li><a href="global.html#makeNotesPanelResizeable">makeNotesPanelResizeable</a></li>
        <li><a href="global.html#makeOptionsDialog">makeOptionsDialog</a></li>
        <li><a href="global.html#mapTitle">mapTitle</a></li>
        <li><a href="global.html#markMapSaved">markMapSaved</a></li>
        <li><a href="global.html#maxScale">maxScale</a></li>
        <li><a href="global.html#mergeTranspose">mergeTranspose</a></li>
        <li><a href="global.html#mostFrequentString">mostFrequentString</a></li>
        <li><a href="global.html#nodeEditCancel">nodeEditCancel</a></li>
        <li><a href="global.html#nodeEditSave">nodeEditSave</a></li>
        <li><a href="global.html#nodeEditSubmit">nodeEditSubmit</a></li>
        <li><a href="global.html#nodeEditUpdateStyleSample">nodeEditUpdateStyleSample</a></li>
        <li><a href="global.html#nodeEditorHide">nodeEditorHide</a></li>
        <li><a href="global.html#nodeEditorShow">nodeEditorShow</a></li>
        <li><a href="global.html#nodeIdToLabel">nodeIdToLabel</a></li>
        <li><a href="global.html#nodeList">nodeList</a></li>
        <li><a href="global.html#noteFilter">noteFilter</a></li>
        <li><a href="global.html#objectEquals">objectEquals</a></li>
        <li><a href="global.html#onexit">onexit</a></li>
        <li><a href="global.html#openCluster">openCluster</a></li>
        <li><a href="global.html#openNotesWindow">openNotesWindow</a></li>
        <li><a href="global.html#panCanvas">panCanvas</a></li>
        <li><a href="global.html#plusLink">plusLink</a></li>
        <li><a href="global.html#plusNode">plusNode</a></li>
        <li><a href="global.html#portrait">portrait</a></li>
        <li><a href="global.html#positionNotes">positionNotes</a></li>
        <li><a href="global.html#positionPopUp">positionPopUp</a></li>
        <li><a href="global.html#progressBar">progressBar</a></li>
        <li><a href="global.html#pushnew">pushnew</a></li>
        <li><a href="global.html#quillAccessor">quillAccessor</a></li>
        <li><a href="global.html#quillEditor">quillEditor</a></li>
        <li><a href="global.html#quillFormatter">quillFormatter</a></li>
        <li><a href="global.html#randomColour">randomColour</a></li>
        <li><a href="global.html#reApplySampleToLinks">reApplySampleToLinks</a></li>
        <li><a href="global.html#reApplySampleToNodes">reApplySampleToNodes</a></li>
        <li><a href="global.html#readSingleFile">readSingleFile</a></li>
        <li><a href="global.html#rebase">rebase</a></li>
        <li><a href="global.html#recalculateStats">recalculateStats</a></li>
        <li><a href="global.html#receiveEvent">receiveEvent</a></li>
        <li><a href="global.html#recreateClusteringMenu">recreateClusteringMenu</a></li>
        <li><a href="global.html#redraw">redraw</a></li>
        <li><a href="global.html#refreshFromMap">refreshFromMap</a></li>
        <li><a href="global.html#refreshSampleLink">refreshSampleLink</a></li>
        <li><a href="global.html#refreshSampleNode">refreshSampleNode</a></li>
        <li><a href="global.html#removeAvatar">removeAvatar</a></li>
        <li><a href="global.html#removeFactorCursor">removeFactorCursor</a></li>
        <li><a href="global.html#removeTitleDropDown">removeTitleDropDown</a></li>
        <li><a href="global.html#renameUser">renameUser</a></li>
        <li><a href="global.html#resizeCanvas">resizeCanvas</a></li>
        <li><a href="global.html#restoreState">restoreState</a></li>
        <li><a href="global.html#rgbIsLight">rgbIsLight</a></li>
        <li><a href="global.html#rgbToArray">rgbToArray</a></li>
        <li><a href="global.html#rgba">rgba</a></li>
        <li><a href="global.html#rollback">rollback</a></li>
        <li><a href="global.html#round">round</a></li>
        <li><a href="global.html#saveChange">saveChange</a></li>
        <li><a href="global.html#saveEdge">saveEdge</a></li>
        <li><a href="global.html#saveLabel">saveLabel</a></li>
        <li><a href="global.html#saveNode">saveNode</a></li>
        <li><a href="global.html#savePRSMfile">savePRSMfile</a></li>
        <li><a href="global.html#saveState">saveState</a></li>
        <li><a href="global.html#saveStr">saveStr</a></li>
        <li><a href="global.html#saveUserName">saveUserName</a></li>
        <li><a href="global.html#search">search</a></li>
        <li><a href="global.html#searchTargets">searchTargets</a></li>
        <li><a href="global.html#seededRandom">seededRandom</a></li>
        <li><a href="global.html#selectClustering">selectClustering</a></li>
        <li><a href="global.html#selectFactorsWithStyle">selectFactorsWithStyle</a></li>
        <li><a href="global.html#selectLinksWithStyle">selectLinksWithStyle</a></li>
        <li><a href="global.html#selectTool">selectTool</a></li>
        <li><a href="global.html#selectUsersItems">selectUsersItems</a></li>
        <li><a href="global.html#selectedLabels">selectedLabels</a></li>
        <li><a href="global.html#sendToBack">sendToBack</a></li>
        <li><a href="global.html#setAnalysisButtonsFromRemote">setAnalysisButtonsFromRemote</a></li>
        <li><a href="global.html#setButtonDisabledStatus">setButtonDisabledStatus</a></li>
        <li><a href="global.html#setButtonStatus">setButtonStatus</a></li>
        <li><a href="global.html#setCanvasBackground">setCanvasBackground</a></li>
        <li><a href="global.html#setEdgeHidden">setEdgeHidden</a></li>
        <li><a href="global.html#setEndOfContenteditable">setEndOfContenteditable</a></li>
        <li><a href="global.html#setFactorSizeFromPercent">setFactorSizeFromPercent</a></li>
        <li><a href="global.html#setFileName">setFileName</a></li>
        <li><a href="global.html#setFixed">setFixed</a></li>
        <li><a href="global.html#setGroupBorderColor">setGroupBorderColor</a></li>
        <li><a href="global.html#setIntersection">setIntersection</a></li>
        <li><a href="global.html#setLegend">setLegend</a></li>
        <li><a href="global.html#setMapTitle">setMapTitle</a></li>
        <li><a href="global.html#setNodeHidden">setNodeHidden</a></li>
        <li><a href="global.html#setRadioVal">setRadioVal</a></li>
        <li><a href="global.html#setUpAwareness">setUpAwareness</a></li>
        <li><a href="global.html#setUpBackground">setUpBackground</a></li>
        <li><a href="global.html#setUpFilter">setUpFilter</a></li>
        <li><a href="global.html#setUpPage">setUpPage</a></li>
        <li><a href="global.html#setUpPinchZoom">setUpPinchZoom</a></li>
        <li><a href="global.html#setUpSamples">setUpSamples</a></li>
        <li><a href="global.html#setUpSamplesMap">setUpSamplesMap</a></li>
        <li><a href="global.html#setUpShareDialog">setUpShareDialog</a></li>
        <li><a href="global.html#setUpSideDrawer">setUpSideDrawer</a></li>
        <li><a href="global.html#setUpTabs">setUpTabs</a></li>
        <li><a href="global.html#setUpToolbox">setUpToolbox</a></li>
        <li><a href="global.html#setUpTutorial">setUpTutorial</a></li>
        <li><a href="global.html#setUpUserName">setUpUserName</a></li>
        <li><a href="global.html#setvh">setvh</a></li>
        <li><a href="global.html#showAvatars">showAvatars</a></li>
        <li><a href="global.html#showClusterLinks">showClusterLinks</a></li>
        <li><a href="global.html#showEdgeData">showEdgeData</a></li>
        <li><a href="global.html#showGhostFactor">showGhostFactor</a></li>
        <li><a href="global.html#showHistory">showHistory</a></li>
        <li><a href="global.html#showNavButtons">showNavButtons</a></li>
        <li><a href="global.html#showNodeData">showNodeData</a></li>
        <li><a href="global.html#showNodeOrEdgeData">showNodeOrEdgeData</a></li>
        <li><a href="global.html#showNotesSwitch">showNotesSwitch</a></li>
        <li><a href="global.html#showOtherMouse">showOtherMouse</a></li>
        <li><a href="global.html#showPressed">showPressed</a></li>
        <li><a href="global.html#showSelected">showSelected</a></li>
        <li><a href="global.html#snapToGrid">snapToGrid</a></li>
        <li><a href="global.html#solve">solve</a></li>
        <li><a href="global.html#splitText">splitText</a></li>
        <li><a href="global.html#standardizeColor">standardizeColor</a></li>
        <li><a href="global.html#start">start</a></li>
        <li><a href="global.html#startY">startY</a></li>
        <li><a href="global.html#statusMsg">statusMsg</a></li>
        <li><a href="global.html#stepFinish">stepFinish</a></li>
        <li><a href="global.html#stepStart">stepStart</a></li>
        <li><a href="global.html#stepsEnd">stepsEnd</a></li>
        <li><a href="global.html#stopEdit">stopEdit</a></li>
        <li><a href="global.html#strip">strip</a></li>
        <li><a href="global.html#stripArray">stripArray</a></li>
        <li><a href="global.html#stripNL">stripNL</a></li>
        <li><a href="global.html#styleEdgeContextMenu">styleEdgeContextMenu</a></li>
        <li><a href="global.html#styleEdgeNames">styleEdgeNames</a></li>
        <li><a href="global.html#styleNodeContextMenu">styleNodeContextMenu</a></li>
        <li><a href="global.html#styleNodeNames">styleNodeNames</a></li>
        <li><a href="global.html#subVec">subVec</a></li>
        <li><a href="global.html#subtract">subtract</a></li>
        <li><a href="global.html#sumVec">sumVec</a></li>
        <li><a href="global.html#svg">svg</a></li>
        <li><a href="global.html#tickToggle">tickToggle</a></li>
        <li><a href="global.html#timeAndDate">timeAndDate</a></li>
        <li><a href="global.html#timekey">timekey</a></li>
        <li><a href="global.html#timestamp">timestamp</a></li>
        <li><a href="global.html#toggleDeleteButton">toggleDeleteButton</a></li>
        <li><a href="global.html#toggleNodeStyleLock">toggleNodeStyleLock</a></li>
        <li><a href="global.html#togglePanel">togglePanel</a></li>
        <li><a href="global.html#toolHandler">toolHandler</a></li>
        <li><a href="global.html#traceUsers">traceUsers</a></li>
        <li><a href="global.html#transpose">transpose</a></li>
        <li><a href="global.html#trophic">trophic</a></li>
        <li><a href="global.html#unCluster">unCluster</a></li>
        <li><a href="global.html#unFollow">unFollow</a></li>
        <li><a href="global.html#unGroup">unGroup</a></li>
        <li><a href="global.html#unSelect">unSelect</a></li>
        <li><a href="global.html#undirected">undirected</a></li>
        <li><a href="global.html#unlockAll">unlockAll</a></li>
        <li><a href="global.html#unlockEdge">unlockEdge</a></li>
        <li><a href="global.html#unlockNode">unlockNode</a></li>
        <li><a href="global.html#unselectTool">unselectTool</a></li>
        <li><a href="global.html#updateActiveButtons">updateActiveButtons</a></li>
        <li><a href="global.html#updateColumnTitle">updateColumnTitle</a></li>
        <li><a href="global.html#updateEdgeCellData">updateEdgeCellData</a></li>
        <li>
          <a href="global.html#updateFactorsOrLinksHiddenByStyle">
            updateFactorsOrLinksHiddenByStyle
          </a>
        </li>
        <li><a href="global.html#updateFilter">updateFilter</a></li>
        <li><a href="global.html#updateFromAndToLabels">updateFromAndToLabels</a></li>
        <li><a href="global.html#updateFromDrawingMap">updateFromDrawingMap</a></li>
        <li><a href="global.html#updateFromRemote">updateFromRemote</a></li>
        <li><a href="global.html#updateLastSamples">updateLastSamples</a></li>
        <li><a href="global.html#updateLegend">updateLegend</a></li>
        <li><a href="global.html#updateLinkEditor">updateLinkEditor</a></li>
        <li><a href="global.html#updateNodeCellData">updateNodeCellData</a></li>
        <li><a href="global.html#updateNodeEditor">updateNodeEditor</a></li>
        <li><a href="global.html#updateSelection">updateSelection</a></li>
        <li><a href="global.html#upgradeFromV1">upgradeFromV1</a></li>
        <li><a href="global.html#uuidv4">uuidv4</a></li>
        <li><a href="global.html#yjsTrace">yjsTrace</a></li>
        <li><a href="global.html#zero">zero</a></li>
        <li><a href="global.html#zoomCanvas">zoomCanvas</a></li>
        <li><a href="global.html#zoomincr">zoomincr</a></li>
        <li><a href="global.html#zoomnet">zoomnet</a></li>
        <li><a href="global.html#zoomscroll">zoomscroll</a></li>
      </ul>
    </nav>

    <div id="main">
      <h1 class="page-title">trophic.js</h1>

      <section>
        <article>
          <pre
            class="prettyprint source linenums"
          ><code>/*********************************************************************************************************************  

PRSM Participatory System Mapper 

    Copyright (C) 2022  Nigel Gilbert prsm@prsm.uk

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see &lt;https://www.gnu.org/licenses/>.


This module does trophic layout.  
 ******************************************************************************************************************** */

/*
translation of the Trophic Levels algorithm to javascript

NG 18 December 2020

*/

/* simple minded adjacency matrix manipulation functions.
 * They generally assume that the matrix is square (no checks are done
 * that they are).
 * Assumes all weights are unity (TODO: allow weighted edges)
 * Matrix data structure is just an array of arrays
 */

import { NLEVELS } from './prsm.js'
/**
 * convert a directed adjacency matrix to an undirected one
 * mirror the elements above the leading diagonal to below it
 * @param {array[]} a
 * @returns {array[]} a copy of a
 */
function undirected(a) {
  const b = Array(a.length)
  for (let i = 0; i &lt; a.length; i++) {
    b[i] = new Array(a.length)
    b[i][i] = a[i][i]
  }
  for (let i = 0; i &lt; a.length; i++) {
    for (let j = i + 1; j &lt; a.length; j++) {
      if (a[i][j] || a[j][i]) {
        b[i][j] = 1
        b[j][i] = 1
      } else {
        b[i][j] = 0
        b[j][i] = 0
      }
    }
  }
  return b
}
/**
 * check that all nodes are connected to at least one other node
 * i.e. every row includes at least one 1
 * @param {array[]} a
 */
function connected(a) {
  for (let i = 0; i &lt; a.length; i++) {
    let nonzero = false
    for (let j = 0; j &lt; a.length; j++) {
      if (a[i][j] !== 0) {
        nonzero = true
        break
      }
    }
    if (!nonzero) return false
  }
  return true
}
/**
 * swap cell values across the leading diagonal
 * @param {array[]} a
 * @returns {array[]} a transposed copy of a
 */
function transpose(a) {
  const b = new Array(a.length)
  for (let i = 0; i &lt; a.length; i++) {
    b[i] = new Array(a.length)
    for (let j = 0; j &lt; a.length; j++) b[i][j] = a[j][i]
  }
  return b
}
/**
 * return a vector of the number of edges out of a node
 * @param {array[]} a
 * @returns {array}
 */
/* eslint-disable camelcase */
function out_degree(a) {
  const v = new Array(a.length)
  for (let row = 0; row &lt; a.length; row++) v[row] = sumVec(a[row])
  return v
}
/**
 * return a vector of the number of edges into a node
 * @param {array[]} a
 * @returns {array}
 */
function in_degree(a) {
  return out_degree(transpose(a))
}
/* eslint-enable camelcase */
/**
 * returns the summation of the values in the vector
 * @param {array} v
 * @returns {number}
 */
function sumVec(v) {
  let sum = 0
  for (let i = 0; i &lt; v.length; i++) sum += v[i]
  return sum
}
/**
 * v1 - v2
 * @param {array} v1
 * @param {array} v2
 * @returns {array}
 */
function subVec(v1, v2) {
  const res = new Array(v1.length)
  for (let i = 0; i &lt; v1.length; i++) res[i] = v1[i] - v2[i]
  return res
}
/**
 * v1 + v2
 * @param {array} v1
 * @param {array} v2
 * @returns {array}
 */
function addVec(v1, v2) {
  const res = new Array(v1.length)
  for (let i = 0; i &lt; v1.length; i++) res[i] = v1[i] + v2[i]
  return res
}
/**
 * subtract matrix b from a
 * @param {array[]} a
 * @param {array[]} b
 */
function subtract(a, b) {
  const c = new Array(a.length)
  for (let i = 0; i &lt; a.length; i++) {
    c[i] = subVec(a[i], b[i])
  }
  return c
}
/**
 * Add matrix a to its transpose, but normalise the cell values resulting to 0/1
 * @param {array[]} a
 * @returns {array[]} a copy of the result
 */
function mergeTranspose(a) {
  const b = transpose(a)
  for (let i = 0; i &lt; a.length; i++) {
    for (let j = 0; j &lt; a.length; j++) if (a[i][j] > 0) b[i][j] = 1
  }
  return b
}
/**
 * create a new matrix of size n, with all cells zero
 * @param {number} n
 */
function zero(n) {
  const b = new Array(n)
  for (let i = 0; i &lt; n; i++) {
    b[i] = new Array(n).fill(0)
  }
  return b
}
/**
 * create a zero matrix with v as the leading diagonal
 * @param {array} v
 * @returns {array[]}
 */
function diag(v) {
  const b = zero(v.length)
  for (let i = 0; i &lt; v.length; i++) {
    b[i][i] = v[i]
  }
  return b
}
/**
 * subtract the minimum value of any cell from each cell of the vector
 * @param {array} v
 */
function rebase(v) {
  const min = Math.min(...v)
  const res = new Array(v.length)
  for (let i = 0; i &lt; v.length; i++) res[i] = v[i] - min
  return res
}
/**
 * solve Ax=B by Gauss-Jordan elimination method
 * adapted from https://www.npmjs.com/package/linear-equation-system
 * @param {array[]} A
 * @param {array} B
 */
function solve(A, B) {
  let system = A.slice()
  for (let i = 0; i &lt; B.length; i++) system[i].push(B[i])

  for (let i = 0; i &lt; system.length; i++) {
    const pivotRow = findPivotRow(system, i)
    if (!pivotRow) return false //Singular system
    if (pivotRow !== i) system = swapRows(system, i, pivotRow)
    const pivot = system[i][i]
    for (let j = i; j &lt; system[i].length; j++) {
      //divide row by pivot
      system[i][j] = system[i][j] / pivot
    }
    for (let j = i + 1; j &lt; system.length; j++) {
      // Cancel below pivot
      if (system[j][i] !== 0) {
        const operable = system[j][i]
        for (let k = i; k &lt; system[i].length; k++) {
          system[j][k] -= operable * system[i][k]
        }
      }
    }
  }
  for (let i = system.length - 1; i > 0; i--) {
    // Back substitution
    for (let j = i - 1; j >= 0; j--) {
      if (system[j][i] !== 0) {
        const operable = system[j][i]
        for (let k = j; k &lt; system[j].length; k++) {
          system[j][k] -= operable * system[i][k]
        }
      }
    }
  }
  const answer = []
  for (let i = 0; i &lt; system.length; i++) {
    answer.push(system[i].pop())
  }
  return answer

  function findPivotRow(sys, index) {
    let row = index
    for (let i = index; i &lt; sys.length; i++) {
      if (Math.abs(sys[i][index]) > Math.abs(sys[row][index])) row = i
    }
    if (sys[row][index] === 0) return false
    return row
  }

  function swapRows(sys, row1, row2) {
    const cache = sys[row1]
    sys[row1] = sys[row2]
    sys[row2] = cache
    return sys
  }
}
/**
 * Round the cell values of v to the given number of decimal places
 * @param {array} v
 * @param {number} places
 */
function round(v, places) {
  for (let i = 0; i &lt; v.length; i++) v[i] = v[i].toFixed(places)
  return v
}

/* --------------------------------------------------------------------*/
/**
 * This is the Trophic Levels Algorithm
 *
 * @param {array[]} a square adjacency matrix
 * @returns {array} levels (heights)
 */
/* eslint-disable camelcase */
function get_trophic_levels(a) {
  // get undirected matrix
  const au = undirected(a)
  // check connected
  if (connected(au)) {
    // get in degree vector
    const in_deg = in_degree(a)
    // get out degree vector
    const out_deg = out_degree(a)
    // get in - out
    const v = subVec(in_deg, out_deg)
    // get diagonal matrix, subtract (adj. matrix plus its transpose)
    const L = subtract(diag(addVec(in_deg, out_deg)), mergeTranspose(a))
    // set (0,0) to zero
    L[0][0] = 0
    // do linear solve
    let h = solve(L, v)
    if (!h) {
      throw new Error('Singular matrix')
    }
    // base to zero
    h = rebase(h)
    // round to 3 decimal places
    h = round(h, 3)
    // return tropic heights
    return h
  } else {
    throw new Error('Network must be weakly connected')
  }
}
/* eslint-enable camelcase */
/**
 * convert a vector of objects, each an edge referencing from and to nodes
 * to an adjacency matrix.  nodes is a list of nodes that acts as the index for the adj. matrix.
 * @param {array} v list of edges
 * @param {array} nodes list of node Ids
 * @returns matrix
 */
function edgeListToAdjMatrix(v, nodes) {
  const a = zero(nodes.length)
  for (let i = 0; i &lt; v.length; i++) {
    a[nodes.indexOf(v[i].from)][nodes.indexOf(v[i].to)] = 1
  }
  return a
}
/**
 * returns a list of the node Ids mentioned in a vector of edges
 * @param {array} v edges
 */
function nodeList(v) {
  const nodes = []
  for (let i = 0; i &lt; v.length; i++) {
    if (nodes.indexOf(v[i].from) === -1) nodes.push(v[i].from)
    if (nodes.indexOf(v[i].to) === -1) nodes.push(v[i].to)
  }
  return nodes
}
/**
 * given a complete set of edges, returns a list of lists of edges, each list being the edges of a connected component
 * @param {object} data
 */
function connectedComponents(data) {
  const edges = data.edges.get()
  const cc = []
  const added = []
  let component = []
  // starting from each edge...
  edges.forEach((e) => {
    if (!added.includes(e)) {
      component = []
      //do a depth first search for connected edges
      dfs(e)
      cc.push(component)
    }
  })
  /**
   * depth first search for edges connected to 'to' or 'from' nodes of this edge
   * adds edges found to component array
   * @param {object} e
   */
  function dfs(e) {
    added.push(e)
    component.push(e)
    edges
      .filter((next) => {
        return (
          e !== next &amp;&amp;
          (next.from === e.to || next.to === e.from || next.from === -e.from || next.to === e.to)
        )
      })
      .forEach((next) => {
        if (!added.includes(next)) dfs(next)
      })
  }
  return cc
}

/**
 * shift the positions of nodes according to the trophic 'height' (actually, here, the x coordinate)
 * @param {object} data
 * @returns list of nodes whose positions have been altered
 */
export function trophic(data) {
  // get a list of lists of connected components, each list being pairs of to and from nodes
  // process each connected component individually
  // nodes that are not connected to anything (degree 0) moved to the base level
  const updatedNodes = []
  // save min and max x coordinates of nodes
  const minX = Math.min(...data.nodes.map((n) => n.x))
  const maxX = Math.max(...data.nodes.map((n) => n.x))
  connectedComponents(data).forEach((edges) => {
    const nodeIds = nodeList(edges)
    const nodes = data.nodes.get(nodeIds)
    // convert to an adjacency matrix
    const adj = edgeListToAdjMatrix(edges, nodeIds)
    // get trophic levels
    let levels = get_trophic_levels(adj)
    // experimental: round levels to integers within the range 0 .. NLEVELS
    let range = Math.max(...levels) - Math.min(...levels)
    levels = levels.map((l) => Math.round((l * NLEVELS) / range))
    // rescale x to match original max and min
    range = Math.max(...levels) - Math.min(...levels)
    // if all nodes are at same trophic height (range === 0, so scale would be infinity), line them up
    const scale = range > 0.000001 ? (maxX - minX) / range : 0
    // move nodes to new positions
    for (let i = 0; i &lt; nodeIds.length; i++) {
      const node = nodes[i]
      node.x = levels[i] * scale + minX
      node.level = levels[i]
      updatedNodes.push(node)
    }
  })
  // move all the rest (i.e. unconnected nodes) to the base level
  data.nodes
    .get()
    .filter((n) => !updatedNodes.some((u) => n.id === u.id))
    .forEach((n) => {
      n.x = minX
      n.level = 0
    })

  return data.nodes.get()
}
</code></pre>
        </article>
      </section>
    </div>

    <br class="clear" />

    <footer>
      Documentation generated by
      <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a>
      on Thu Feb 12 2026 09:47:59 GMT+0000 (Greenwich Mean Time) using the
      <a href="https://github.com/clenemt/docdash">docdash</a>
      theme.
    </footer>

    <script>
      prettyPrint()
    </script>
    <script src="scripts/polyfill.js"></script>
    <script src="scripts/linenumber.js"></script>
  </body>
</html>
